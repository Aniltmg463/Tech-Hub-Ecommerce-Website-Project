# Component Diagram - System Components

## Overview
This document contains Component Diagrams for the TechHub E-Commerce system. These diagrams show the organization and dependencies among software components, interfaces, and their relationships.

## Component Diagrams

### 1. Frontend Component Architecture

```plantuml
@startuml Frontend_Components

title TechHub E-Commerce - Frontend Component Architecture

package "React Application" {
    component [App.js] as app
    component [index.js] as index

    package "Pages" {
        component [HomePage] as home
        component [ProductDetails] as productPage
        component [CartPage] as cart
        component [Login] as login
        component [Register] as register
        component [AdminDashboard] as adminDash
        component [UserDashboard] as userDash
    }

    package "Components" {
        package "Layout" {
            component [Header] as header
            component [Footer] as footer
            component [Layout] as layout
            component [AdminMenu] as adminMenu
            component [UserMenu] as userMenu
        }

        package "Form" {
            component [SearchInput] as search
            component [CategoryForm] as categoryForm
        }

        package "Routes" {
            component [PrivateRoute] as privateRoute
            component [AdminRoute] as adminRoute
        }

        component [Spinner] as spinner
    }

    package "Context" {
        component [AuthContext] as authContext
        component [CartContext] as cartContext
        component [SearchContext] as searchContext
    }

    package "Hooks" {
        component [useCategory] as useCategory
    }

    package "Config" {
        component [axios.js] as axiosConfig
    }
}

' Dependencies
index --> app : renders
app --> home
app --> productPage
app --> cart
app --> login
app --> register
app --> adminDash
app --> userDash

home --> layout
productPage --> layout
cart --> layout

layout --> header
layout --> footer

adminDash --> adminMenu
userDash --> userMenu

header --> search

app --> privateRoute
app --> adminRoute

privateRoute --> spinner
adminRoute --> spinner

app --> authContext : provides
app --> cartContext : provides
app --> searchContext : provides

home --> useCategory : uses
productPage --> useCategory : uses

authContext --> axiosConfig : configures
cartContext --> axiosConfig : uses
searchContext --> axiosConfig : uses

note right of authContext
  **Auth Context:**
  • User state
  • JWT token
  • Loading state
  • localStorage sync
  • Axios header config
end note

note right of cartContext
  **Cart Context:**
  • Cart items array
  • localStorage persistence
  • Add/remove items
  • Calculate total
end note

note right of axiosConfig
  **Axios Configuration:**
  • Base URL setup
  • Request interceptor
  • Response interceptor
  • Global error handling
  • 401 redirect logic
end note

@enduml
```

### 2. Backend Component Architecture

```plantuml
@startuml Backend_Components

title TechHub E-Commerce - Backend Component Architecture

package "Express Server" {
    component [index.js] as server

    package "Routes" {
        component [authRoutes.js] as authRoutes
        component [productRoutes.js] as productRoutes
        component [categoryRoutes.js] as categoryRoutes
    }

    package "Controllers" {
        component [authController.js] as authCtrl
        component [productController.js] as productCtrl
        component [categoryController.js] as categoryCtrl
    }

    package "Middlewares" {
        component [authmiddleware.js] as authMiddleware
        component [CORS] as cors
        component [express-formidable] as formidable
    }

    package "Models" {
        component [userModel.js] as userModel
        component [productModel.js] as productModel
        component [categoryModel.js] as categoryModel
        component [orderModel.js] as orderModel
    }

    package "Helpers" {
        component [authHelper.js] as authHelper
        component [jaccard.js] as jaccard
    }

    package "Config" {
        component [db.js] as dbConfig
    }
}

database "MongoDB" as mongo

cloud "Braintree" as braintree

' Server setup
server --> dbConfig : connects
dbConfig --> mongo : Mongoose

server --> cors : uses
server --> authRoutes : mounts
server --> productRoutes : mounts
server --> categoryRoutes : mounts

' Auth flow
authRoutes --> authMiddleware : protected routes
authRoutes --> authCtrl : delegates
authCtrl --> authHelper : uses
authCtrl --> userModel : queries
authCtrl --> orderModel : queries
userModel --> mongo : CRUD

' Product flow
productRoutes --> authMiddleware : admin routes
productRoutes --> formidable : file upload
productRoutes --> productCtrl : delegates
productCtrl --> productModel : queries
productCtrl --> jaccard : similarity
productCtrl --> braintree : payment
productModel --> mongo : CRUD

' Category flow
categoryRoutes --> authMiddleware : admin routes
categoryRoutes --> categoryCtrl : delegates
categoryCtrl --> categoryModel : queries
categoryModel --> mongo : CRUD

' Order flow
orderModel --> productModel : references
orderModel --> userModel : references

note right of authMiddleware
  **Auth Middleware:**
  • requireSignIn:
    Verifies JWT token
  • isAdmin:
    Checks role = 1
end note

note right of authHelper
  **Auth Helper:**
  • hashPassword()
  • comparePassword()
  • Uses Bcrypt
end note

note right of jaccard
  **Jaccard Helper:**
  • tokenize()
  • calculateSimilarity()
  • jaccardDetailed()
  • Product recommendations
end note

note right of formidable
  **File Upload:**
  • Parses multipart/form-data
  • Handles image uploads
  • Size validation
end note

@enduml
```

### 3. Full System Component Diagram

```plantuml
@startuml Full_System_Components

title TechHub E-Commerce - Complete System Components

package "Client (Browser)" {
    [React App] as reactApp
    [React Router] as router
    [Axios Client] as axios
    [LocalStorage] as storage
}

package "Server (Express)" {
    [API Routes] as routes
    [Middleware Pipeline] as middleware
    [Controllers] as controllers
    [Models] as models
    [Helpers] as helpers
}

package "Database" {
    database "MongoDB Atlas" as db
}

package "External Services" {
    [Braintree API] as braintree
    [SMTP Server] as smtp
}

' Client internal
reactApp --> router : navigation
reactApp --> axios : HTTP calls
reactApp --> storage : persistence

' Client to Server
axios --> routes : REST API

' Server internal
routes --> middleware : request processing
middleware --> controllers : validated requests
controllers --> models : data operations
controllers --> helpers : utilities

' Server to Database
models --> db : Mongoose ODM

' Server to External
controllers --> braintree : payments
controllers --> smtp : emails

' Interfaces
interface "REST API" as restAPI
interface "Mongoose" as mongooseIface
interface "Payment API" as paymentAPI
interface "Email API" as emailAPI

routes -up- restAPI
axios -down- restAPI

models -down- mongooseIface
db -up- mongooseIface

controllers -down- paymentAPI
braintree -up- paymentAPI

controllers -down- emailAPI
smtp -up- emailAPI

note top of reactApp
  **Frontend Components:**
  • Pages (HomePage, ProductDetails, etc.)
  • UI Components (Header, Footer, etc.)
  • Context Providers (Auth, Cart, Search)
  • Custom Hooks (useCategory)
  • Routing configuration
end note

note bottom of controllers
  **Backend Controllers:**
  • authController: User & auth management
  • productController: Product & payment
  • categoryController: Category management

  **Business Logic:**
  • Validation
  • Data transformation
  • Service orchestration
end note

note bottom of models
  **Data Models:**
  • User (authentication, profile)
  • Product (catalog, inventory)
  • Category (classification)
  • Order (transactions)

  **Schema Features:**
  • Validation rules
  • Relationships (refs)
  • Timestamps
  • Indexes
end note

@enduml
```

### 4. Component Dependencies and Interfaces

```plantuml
@startuml Component_Dependencies

title TechHub E-Commerce - Component Dependencies

component [Frontend\nReact App] as frontend
component [Backend\nExpress Server] as backend
component [MongoDB\nDatabase] as database
component [Braintree\nPayment] as payment
component [Email\nService] as email

interface "HTTP REST API\n/api/v1/*" as httpAPI
interface "Mongoose ODM\nConnection" as mongooseAPI
interface "Braintree SDK\nPayment API" as braintreeAPI
interface "SMTP\nEmail Protocol" as smtpAPI

frontend -down-> httpAPI : uses
backend -up-> httpAPI : provides

backend -down-> mongooseAPI : uses
database -up-> mongooseAPI : provides

backend -right-> braintreeAPI : uses
payment -left-> braintreeAPI : provides

backend -right-> smtpAPI : uses
email -left-> smtpAPI : provides

note right of httpAPI
  **REST API Endpoints:**

  **Authentication:**
  • POST /api/v1/auth/register
  • POST /api/v1/auth/login
  • GET /api/v1/auth/user-auth
  • GET /api/v1/auth/admin-auth

  **Products:**
  • GET /api/v1/product/get-product
  • POST /api/v1/product/create-product
  • GET /api/v1/product/:slug
  • GET /api/v1/product/related/:pid/:cid

  **Categories:**
  • GET /api/v1/category/get-category
  • POST /api/v1/category/create-category

  **Payment:**
  • GET /api/v1/product/braintree/token
  • POST /api/v1/product/braintree/payment
end note

note right of mongooseAPI
  **Database Operations:**
  • connect()
  • find()
  • findById()
  • create()
  • updateOne()
  • deleteOne()
  • aggregate()
end note

note right of braintreeAPI
  **Payment Operations:**
  • clientToken.generate()
  • transaction.sale()
  • transaction.find()
end note

@enduml
```

### 5. Package Dependencies

```plantuml
@startuml Package_Dependencies

title TechHub E-Commerce - Package Dependencies

package "Frontend Dependencies" {
    [react@18.3.1] as react
    [react-router-dom@6.29] as router
    [axios] as axios
    [antd] as antd
    [bootstrap@5.3.3] as bootstrap
    [react-toastify] as toast
    [braintree-web-drop-in-react] as braintreeDrop
}

package "Backend Dependencies" {
    [express] as express
    [mongoose] as mongoose
    [jsonwebtoken] as jwt
    [bcrypt] as bcrypt
    [braintree] as braintreeSDK
    [cors] as cors
    [express-formidable] as formidable
    [morgan] as morgan
    [slugify] as slugify
}

package "Development Dependencies" {
    [nodemon] as nodemon
    [concurrently] as concurrently
}

' Frontend app
component "React App" as app
app --> react : uses
app --> router : uses
app --> axios : uses
app --> antd : uses
app --> bootstrap : uses
app --> toast : uses
app --> braintreeDrop : uses

' Backend server
component "Express Server" as server
server --> express : uses
server --> mongoose : uses
server --> jwt : uses
server --> bcrypt : uses
server --> braintreeSDK : uses
server --> cors : uses
server --> formidable : uses
server --> morgan : uses
server --> slugify : uses

' Development
component "Dev Environment" as dev
dev --> nodemon : uses
dev --> concurrently : uses

note right of react
  **Frontend Stack:**
  • React 18.3 (UI library)
  • Router (navigation)
  • Axios (HTTP client)
  • Ant Design (UI components)
  • Bootstrap (CSS framework)
  • Toastify (notifications)
  • Braintree Drop-in (payments)
end note

note right of express
  **Backend Stack:**
  • Express (web framework)
  • Mongoose (MongoDB ODM)
  • JWT (authentication)
  • Bcrypt (password hashing)
  • Braintree SDK (payments)
  • CORS (cross-origin)
  • Formidable (file uploads)
  • Morgan (logging)
  • Slugify (URL slugs)
end note

@enduml
```

## How to View These Diagrams

### In VS Code
1. Install "PlantUML" extension by jebbs
2. Copy each PlantUML code block
3. Create separate `.puml` files
4. Press `Alt+D` to preview

### Online
1. Go to: http://www.plantuml.com/plantuml/uml/
2. Copy code between \`\`\`plantuml tags
3. Paste and view

## Component Diagram Explanations

### 1. Frontend Component Architecture

**Purpose:** Shows React application structure and component relationships.

**Key Packages:**

1. **Pages**
   - Top-level route components
   - Compose smaller components
   - Handle page-level logic

2. **Components**
   - Reusable UI components
   - Layout components (Header, Footer, Layout)
   - Form components (SearchInput, CategoryForm)
   - Route protection (PrivateRoute, AdminRoute)

3. **Context**
   - Global state management
   - AuthContext: User authentication state
   - CartContext: Shopping cart state
   - SearchContext: Search results state

4. **Hooks**
   - Custom React hooks
   - useCategory: Fetches category list
   - Reusable stateful logic

5. **Config**
   - axios.js: HTTP client configuration
   - Interceptors for requests/responses

**Component Relationships:**
- App.js is the root component
- Pages use Layout component
- Layout composes Header and Footer
- Context providers wrap the entire app
- Hooks are used by multiple components

### 2. Backend Component Architecture

**Purpose:** Shows Express server structure and dependencies.

**Key Packages:**

1. **Routes**
   - Define API endpoints
   - Apply middleware
   - Delegate to controllers

2. **Controllers**
   - Business logic implementation
   - Request validation
   - Response formatting
   - Orchestrate models and services

3. **Middlewares**
   - Request processing pipeline
   - Authentication (JWT verification)
   - Authorization (role checking)
   - File upload handling (Formidable)
   - CORS policy

4. **Models**
   - Mongoose schema definitions
   - Database interaction
   - Data validation
   - Relationships between entities

5. **Helpers**
   - Utility functions
   - authHelper: Password hashing/comparison
   - jaccard: Similarity calculations

6. **Config**
   - db.js: MongoDB connection setup

**Flow:**
```
Request → Routes → Middleware → Controller → Model → Database
                                     ↓
                                  Helpers
```

### 3. Full System Component Diagram

**Purpose:** Shows all major components and their interactions.

**Components:**

1. **Client (Browser)**
   - React App: UI rendering
   - React Router: Navigation
   - Axios Client: HTTP communication
   - LocalStorage: Client-side persistence

2. **Server (Express)**
   - API Routes: Endpoint definitions
   - Middleware Pipeline: Request processing
   - Controllers: Business logic
   - Models: Data layer
   - Helpers: Utilities

3. **Database**
   - MongoDB Atlas: Cloud database

4. **External Services**
   - Braintree API: Payment processing
   - SMTP Server: Email delivery

**Interfaces:**

- **REST API**: HTTP-based communication between client and server
- **Mongoose**: ODM for MongoDB interaction
- **Payment API**: Braintree SDK integration
- **Email API**: SMTP protocol for email sending

### 4. Component Dependencies and Interfaces

**Purpose:** Shows provided and required interfaces.

**REST API Interface:**
All endpoints follow REST conventions:
- **GET**: Retrieve resources
- **POST**: Create resources
- **PUT**: Update resources
- **DELETE**: Remove resources

**Key Endpoints:**

| Endpoint | Method | Purpose |
|----------|--------|---------|
| `/api/v1/auth/register` | POST | User registration |
| `/api/v1/auth/login` | POST | User authentication |
| `/api/v1/product/get-product` | GET | Fetch all products |
| `/api/v1/product/create-product` | POST | Create product (admin) |
| `/api/v1/product/related/:pid/:cid` | GET | Get similar products |
| `/api/v1/category/get-category` | GET | Fetch all categories |
| `/api/v1/product/braintree/token` | GET | Get payment token |
| `/api/v1/product/braintree/payment` | POST | Process payment |

**Mongoose Interface:**
Standard Mongoose methods:
- `find()`, `findById()`, `findOne()`
- `create()`, `insertMany()`
- `updateOne()`, `updateMany()`, `findByIdAndUpdate()`
- `deleteOne()`, `deleteMany()`, `findByIdAndDelete()`
- `aggregate()` for complex queries

**Braintree Interface:**
- `clientToken.generate()`: Get client token for Drop-in UI
- `transaction.sale()`: Process payment transaction
- `transaction.find()`: Query transaction details

### 5. Package Dependencies

**Purpose:** Shows third-party library dependencies.

**Frontend Dependencies:**

| Package | Version | Purpose |
|---------|---------|---------|
| react | 18.3.1 | UI library |
| react-router-dom | 6.29 | Client-side routing |
| axios | latest | HTTP client |
| antd | latest | UI components |
| bootstrap | 5.3.3 | CSS framework |
| react-toastify | latest | Toast notifications |
| braintree-web-drop-in-react | latest | Payment UI |

**Backend Dependencies:**

| Package | Version | Purpose |
|---------|---------|---------|
| express | latest | Web framework |
| mongoose | latest | MongoDB ODM |
| jsonwebtoken | latest | JWT authentication |
| bcrypt | latest | Password hashing |
| braintree | latest | Payment SDK |
| cors | latest | CORS middleware |
| express-formidable | latest | File upload |
| morgan | latest | Request logging |
| slugify | latest | URL-friendly slugs |

**Development Dependencies:**

| Package | Purpose |
|---------|---------|
| nodemon | Auto-restart server on changes |
| concurrently | Run multiple npm scripts |

## Component Communication Patterns

### 1. Frontend to Backend
- **Pattern**: HTTP REST API
- **Protocol**: HTTPS
- **Format**: JSON
- **Authentication**: JWT in Authorization header

### 2. Backend to Database
- **Pattern**: ODM (Object-Document Mapper)
- **Library**: Mongoose
- **Protocol**: MongoDB Wire Protocol
- **Connection**: Connection pool

### 3. Backend to Braintree
- **Pattern**: SDK integration
- **Library**: Braintree Node.js SDK
- **Protocol**: HTTPS REST API
- **Authentication**: API keys (merchant ID, public/private keys)

### 4. Backend to Email
- **Pattern**: SMTP client
- **Protocol**: SMTP
- **Authentication**: Username/password or API key

## Component Lifecycle

### Frontend Components

**Mount → Render → Update → Unmount**

```javascript
useEffect(() => {
    // Component mounted
    fetchData();

    return () => {
        // Component unmounting
        cleanup();
    };
}, [dependencies]);
```

### Backend Components

**Initialize → Listen → Process → Respond**

```javascript
// Server initialization
app.listen(PORT, () => {
    console.log("Server started");
});

// Request processing
app.post('/api/endpoint', middleware, controller);
```

## Component Testing Strategy

### Frontend Testing
- **Unit Tests**: Individual components (Jest + React Testing Library)
- **Integration Tests**: Component interactions
- **E2E Tests**: Full user workflows (Cypress, Selenium)

### Backend Testing
- **Unit Tests**: Controllers, helpers (Jest, Mocha)
- **Integration Tests**: API endpoints (Supertest)
- **Database Tests**: Model operations (MongoDB Memory Server)

## Component Replacement Strategy

### Replaceable Components:

| Component | Current | Alternative Options |
|-----------|---------|---------------------|
| **Payment Gateway** | Braintree | Stripe, PayPal, Square |
| **Database** | MongoDB | PostgreSQL, MySQL |
| **Email Service** | SMTP | SendGrid, AWS SES, Mailgun |
| **UI Framework** | Bootstrap + Ant Design | Material-UI, Chakra UI |
| **State Management** | Context API | Redux, Zustand, Recoil |
| **ODM** | Mongoose | TypeORM, Prisma |

## Related Diagrams

- [OBJECT_MODELING.md](OBJECT_MODELING.md) - Shows data models used by these components
- [SEQUENCE_DIAGRAM.md](SEQUENCE_DIAGRAM.md) - Shows component interactions over time
- [DEPLOYMENT_DIAGRAM.md](DEPLOYMENT_DIAGRAM.md) - Shows component deployment

---

**Last Updated:** 2025-11-23
**Diagram Type:** UML Component Diagram
**Purpose:** Software Component Organization and Dependencies
